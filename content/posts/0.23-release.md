---
title: "Pyodide 0.23.0 release"
date: 2023-03-30
tags: ["release", "announcement"]
author: "TODO"
showToc: true
TocOpen: false
hidemeta: false
comments: false
# description: ""
disableHLJS: true # to disable highlightjs
disableShare: false
hideSummary: false
searchHidden: true
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
---

Pyodide 0.23 is a major release focused on updating CPython version to 3.11,
which also brings several new features, enhancements, and bug fixes. This
release includes updates to the Python standard library, deployment and build
system enhancements, and new CLI commands. We also added several new packages
to Pyodide, including fastparquet, pynacl and mypy (binary wheels).

Note that there are several API deprecations; please refer to the
[changelog](https://pyodide.org/en/stable/project/changelog.html#version-0-23-0)
for details.

## Updating to Python 3.11.2

Pyodide 0.23 uses CPython 3.11.2 which in addition to [many feature and
enhancements](https://docs.python.org/3/whatsnew/3.11.html) is also the first
version to officially support the WebAssembly as a [PEP11 Tier
3](https://peps.python.org/pep-0011/#tier-3) platform.

For year Pyodide has been distributing a custom build of CPython with many patches.
Now that we can rely on a mostly unmodified CPython, it has become significantly easier
to update CPython versions which is very positive for the
project sustainability. We are very grateful for the CPython maintainers
[¹](#acknowledgments) who made this possible.

Python 3.11 is estimated to be between 10-60% faster than Python 3.10 for
native execution, and we see comparable improvements with the WebAssembly
runtime on our benchmark suite.

## Load time and size optimizations

Reducing the load time and size of a minimal web page using Pyodide has been a
continuous effort. Several techniques have been implemented aiming to reduce
download size,
 - tests and some standard library modules are unvendored when Pyodide is
   initialized with `loadPyodide({..., fullStdLib=False})`, the default
   currently, and need to be explictly loaded. In this release we additionally
   unvendored `_pydecimal` and `pydoc_data` modules.
 - Pyodide no longer uses Emscripten preload plugin, and `pyodide.asm.data`
   file is removed, in favor of `python_stdlib.zip`. This would make it easier
   to adjust the contents of this file if needed, particularly that
   `loadPyodide` can now load it from a custom location using the `stdLibURL`
   parameter.
 - Python standard libraries are now vendored in a zipfile:
   /lib/python{version}.zip in the in-browser MEMFS file system. If you need to
   access the standard library source code, you need to unpack the zip file.

To some extent however, these optimizations have been offset by the
growth of the Python standard library, and the enabling additional
functionality over time. 

As can be seen in the following graph, there are size increases for each major Python version, with an overall slowly decreasing trend for the download size,

<img src="download_size_evolution.webp" alt="Download size evolution for the Python REPL" />

In this release we have also added a py-compiled build for the Python standard
library and packages. This leads to faster initialization times, however because the size
of .pyc files increased in Python 3.11
([cpython#99554](https://github.com/python/cpython/issues/99554)) the overall download
size is larger.

--------------------------------------------
|        | full | py-compiled |
|--------|------|-------------|
| Download size of Python + sdlib (Brotli compressed) |  5.3 MB |      6.9 MB    | 
| Load + initialization time (Firefox) |  1.3 s |      0.87 s    |
| Load + initialization time (Chrome)  |  0.85 s |      0.46 s    |

Similarly load time improvements x1.2 - x2.0 were observed for larger packages such as pandas, sympy or scikit-learn ([pyodide#3269](https://github.com/pyodide/pyodide/issues/3269))

You can use to py-compiled builds by either setting,
```
https://cdn.jsdelivr.net/pyodide/v0.23.0/pyc/
```
as the `indexURL` or by appending `?build=pyc` to [the REPL
URL](https://pyodide.org/en/stable/console.html?build=pyc). Pyodide CLI now
also has a command `pyodide py-compile` to py-compile Python wheels to for a
given Python version.

A known limitation of py-compiled builds is that the error traceback no longer
contain code snippets, only the line numbers.

## Javascript API and Foreign Function Interface


## The build system and CLI

In this release we have finished deprecating all `pyodide-build` based commands, in favor of switching to the top level `pyodide` CLI,
```
$ pyodide --help
 Usage: pyodide [OPTIONS] COMMAND [ARGS]...                                                
                                                                                           
 A command line interface for Pyodide.                                                     
 Other CLI subcommands are registered via the plugin system by installing Pyodide          
 compatible packages (e.g. pyodide-build).                                                 
                                                                                           
╭─ Registered by: auditwheel_emscripten ──────────────────────────────────────────────────╮
│ auditwheel  Auditwheel-like tool for emscripten wheels and shared libraries.            │
╰─────────────────────────────────────────────────────────────────────────────────────────╯
╭─ Registered by: pyodide-build ──────────────────────────────────────────────────────────╮
│ build          Use pypa/build to build a Python package from source, pypi or url.       │
│ build-recipes  Build packages using yaml recipes and create repodata.json               │
│ config         Manage config variables used in pyodide                                  │
│ py-compile     Compile .py files to .pyc in a wheel, a zip file, or a folder with       │
│                wheels or zip files.                                                     │
│ skeleton       Add a new package build recipe or update an existing recipe              │
│ venv           Create a Pyodide virtual environment                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────╯
```

In this release, `pyodide build-recipes` had many improvements, such as nicer progress logging with Rich, auto-detection of the number of CPUs for parallel builds, and the `--no-deps` option to skip dependency resolution.

As to `pyodide build` command for building wheels out-of-tree, it can now builds a list of packages in a `requirements.txt` file via the `-r <requirements.txt>` parameter. It can also recursively build package dependencies with the `--build-dependencies` option and allows better build reproducibility with the `--output-lockfile` parameter.


## Acknowledgements

Thanks to everyone who contributed code to this release and all users who
reported issues and provided feedback. 

The following people commited to Pyodide in this release:

Alexey Ignatiev, Andrea Giammarchi, Arpit, Christian Clauss, Deepak Cherian,
Eli Lamb, Feodor Fitsner, Gyeongjae Choi, Hood Chatham, Jeff Glass, Jo Bovy,
Joe Marshall, josephrocca, Loïc Estève, martinRenou, messense, Nicholas
Bollweg, Roman Yurchak, TheOnlyWayUp, Victor Blomqvist, Ye Joo Park
